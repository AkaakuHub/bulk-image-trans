<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>画像翻訳アプリケーション</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <div class="col-md-3 sidebar">
                <div class="text-center mb-4">
                    <h1 class="app-title">
                        <i class="fas fa-language"></i> 画像翻訳
                    </h1>
                    <p class="text-muted">画像内のテキストを自動翻訳</p>
                </div>

                <!-- 設定パネル -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-cog"></i> 設定
                        </h5>
                    </div>
                    <div class="card-body">
                        <form id="settingsForm">
                            <!-- OCR言語 -->
                            <div class="mb-3">
                                <label class="form-label">OCR言語</label>
                                <select class="form-select" id="ocrLanguages" name="ocr_languages">
                                    <option value="en,ja">英語 + 日本語</option>
                                    <option value="en">英語のみ</option>
                                    <option value="ja">日本語のみ</option>
                                    <option value="en,zh">英語 + 中国語</option>
                                    <option value="zh">中国語のみ</option>
                                </select>
                            </div>

                            <!-- 翻訳先言語 -->
                            <div class="mb-3">
                                <label class="form-label">翻訳先言語</label>
                                <select class="form-select" id="targetLanguage" name="target_language">
                                    <option value="Japanese">日本語</option>
                                    <option value="English">英語</option>
                                    <option value="Chinese">中国語</option>
                                </select>
                            </div>

                            <!-- GPU設定 -->
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="useGpu" name="use_gpu" checked>
                                    <label class="form-check-label" for="useGpu">
                                        GPUを使用
                                    </label>
                                </div>
                            </div>

                            <!-- ファイル選択 -->
                            <div class="mb-3">
                                <label class="form-label">画像ファイル</label>
                                <input type="file" class="form-control" id="fileInput" multiple accept="image/*">
                                <div class="form-text">複数の画像ファイルを選択できます</div>
                            </div>

                            <button type="submit" class="btn btn-primary w-100" id="startBtn">
                                <i class="fas fa-play"></i> 翻訳開始
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- メインコンテンツ -->
            <div class="col-md-9 main-content">
                <!-- 進捗パネル -->
                <div class="progress-panel" id="progressPanel" style="display: none;">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-tasks"></i> 処理進捗
                            </h5>
                            <button class="btn btn-sm btn-outline-danger" id="cancelBtn">
                                <i class="fas fa-stop"></i> 中止
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="progress mb-3">
                                <div class="progress-bar" id="progressBar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <small class="text-muted">状態:</small>
                                    <div id="progressStatus">準備完了</div>
                                </div>
                                <div class="col-md-6 text-end">
                                    <small class="text-muted">進捗:</small>
                                    <div id="progressText">0/0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ログパネル -->
                <div class="log-panel">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-list"></i> 処理ログ
                            </h5>
                            <button class="btn btn-sm btn-outline-secondary" id="clearLogBtn">
                                <i class="fas fa-trash"></i> クリア
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="logContainer" class="log-container">
                                <div class="log-item">
                                    <span class="log-time">--:--:--</span>
                                    <span class="log-message">アプリケーションを準備しました</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 結果パネル -->
                <div class="results-panel" id="resultsPanel" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-download"></i> 翻訳結果
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="resultsContainer" class="results-container">
                                <!-- 結果がここに表示されます -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ローディングオーバーレイ -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">処理中...</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>